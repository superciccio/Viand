use TodoItem from "./TodoItem.viand"
use State from "./State.viand"

component App:
    $title: string = "Viand Task Manager (Live)"
    $todos: array = []
    $newTodo: string = ""

    fn addTodo():
        if $newTodo.trim():
            # CALLING THE SQL SIBLING!
            sql.save($newTodo)
            
            $todos = [...$todos, { text: $newTodo, done: false }]
            $newTodo = ""

    fn loadData():
        $todos = sql.loadAll()


    view:
        div .container:
            h1: State.executiveName + "'s Tasks"
            
            div .input-group:
                input(bind:value: $newTodo, placeholder: "What needs to be done?")
                button -> click(addTodo): "Add"

            div .list:
                each $todo in $todos:
                    TodoItem(task: $todo.text, bind:done: $todo.done)

    style:
        .container:
            max-width: 400px
            margin: 0 auto
            padding: 20px
            font-family: sans-serif

        .input-group:
            display: flex
            gap: 10px
            margin-bottom: 20px

        input:
            flex: 1
            padding: 8px

test App:
    @logic:
        must $todos.length == 0
        $newTodo = "Research Tauri"
        addTodo()
        must $todos.length == 1
        must $todos[0].text == "Research Tauri"

// trigger
